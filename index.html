<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="manifest" href="data:application/manifest+json,{'name':'MiCine','display':'standalone'}">

    <title>Mi Cine Premium</title>
    <style>
        body { background: #000; color: white; font-family: sans-serif; margin: 0; padding: 0; }
        .header { height: 60px; background: #111; display: flex; align-items: center; padding: 0 20px; border-bottom: 2px solid #a855f7; position: sticky; top: 0; z-index: 100; }
        .contenedor { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 20px; }
        .card { background: #1a1a1a; border-radius: 8px; overflow: hidden; border: 1px solid #333; }
        .card img { width: 100%; aspect-ratio: 2/3; object-fit: cover; background: #222; }
        .card-info { padding: 10px; font-size: 13px; font-weight: bold; text-align: center; }
        
        /* Secciones de info */
        .full-info { display: none; position: fixed; inset: 0; background: #000; z-index: 1000; overflow-y: auto; padding-bottom: 40px; }
        .category-tag { color: #a855f7; font-size: 12px; font-weight: bold; margin-bottom: 10px; display: block; }
        .desc { color: #ccc; line-height: 1.5; font-size: 14px; }
        
        #player-ui { display: none; position: fixed; inset: 0; background: #000; z-index: 2000; }
        iframe { width: 100%; height: calc(100% - 80px); border: none; }
        .footer { height: 80px; background: #111; display: flex; align-items: center; justify-content: space-around; }
        .btn { background: #a855f7; color: white; border: none; padding: 12px 25px; border-radius: 5px; font-weight: bold; }
    </style>
</head>
<body>

<div class="header"><h2>MI CINE</h2></div>
<div class="contenedor" id="catalogo">
    <p id="msg" style="grid-column: 1/-1; text-align: center; color: #555;">Cargando catálogo...</p>
</div>

<div id="pantalla-info" class="full-info">
    <div style="width:100%; height:250px; background:#222;" id="trailer-cont"></div>
    <div style="padding: 20px;">
        <h1 id="info-t"></h1>
        <span class="category-tag" id="info-c"></span>
        <p class="desc" id="info-d"></p>
        <div style="display:flex; gap:10px;">
            <button class="btn" onclick="play()">REPRODUCIR</button>
            <button class="btn" style="background:#444" onclick="cerrar()">VOLVER</button>
        </div>
    </div>
</div>

<div id="player-ui">
    <iframe id="vid" allowfullscreen></iframe>
    <div class="footer">
        <button class="btn" onclick="document.getElementById('player-ui').style.display='none'; document.getElementById('vid').src='';">SALIR</button>
        <span id="ep-t">Episodio 1</span>
    </div>
</div>

<script>
    const API_KEY = '6de1162b511f00bd38d39d7eb38396e9';
    const movies = [
        {id: '37863', type: 'tv', drive: '1H05vvUGWykQ6tnuApYV6EOEREVf4Kkqa'},
        {id: '533535', type: 'movie', drive: '1Dqj5yyS1hoU42x6KqCNEdnYvCYsaGfY2'}
    ];

    let selected = null;

    async function load() {
        const res = document.getElementById('catalogo');
        try {
            for(let m of movies) {
                const r = await fetch(https://api.themoviedb.org/3/${m.type}/${m.id}?api_key=${API_KEY}&language=es-ES);
                const data = await r.json();
                const div = document.createElement('div');
                div.className = 'card';
                div.onclick = () => show(data, m.drive);
                div.innerHTML = <img src="https://image.tmdb.org/t/p/w500${data.poster_path}"><div class="card-info">${data.name || data.title}</div>;
                res.appendChild(div);
            }
            document.getElementById('msg').style.display = 'none';
        } catch(e) {
            document.getElementById('msg').innerText = "Error de conexión. Intenta subir el archivo a internet.";
        }
    }

    function show(data, drive) {
        selected = drive;
        document.getElementById('pantalla-info').style.display = 'block';
        document.getElementById('info-t').innerText = data.name || data.title;
        document.getElementById('info-d').innerText = data.overview;
        document.getElementById('info-c').innerText = "GÉNEROS: " + data.genres.map(g => g.name).join(' / ');
    }

    function play() {
        document.getElementById('player-ui').style.display = 'block';
        document.getElementById('vid').src = https://drive.google.com/file/d/${selected}/preview;
    }

    function cerrar() { document.getElementById('pantalla-info').style.display = 'none'; }

    load();
</script>
</body>
</html>
